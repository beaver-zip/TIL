## Comand Injection

<img src='https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99ADC6355C89D4D42E'>

Command Injection은 웹 애플리케이션에서 시스템 명령을 사용할 때, 세미콜론 혹은 &, && 를 사용하여 하나의 Command를 Injection 하여 두 개의 명령어가 실행되게 하는 공격이다. OWASP Top10 중 1위에 속해 있는 Injection 공격으로 서버자체의 콘솔 명령어를 실행시킬 수 있기 때문에 공격이 성공한다면 매우 큰 피해가 발생할 수 있다.

그림은 Command Injection 공격의 한 예를 보여준다. 현재 웹 애플리케이션에서는 서버의 파일을 cat 명령어를 사용하여 사용자 입력과 함께 보여줄 수 있도록 만들어져 있다. 해커는 이 기능을 악용하여 리눅스에서 

1. 두 개의 명령을 한 줄에 동시에 실행할 수 있도록 하는 연결자인 “세미콜론”을 사용하여 ifconfig 명령을 실행시키기 위해 웹 페이지에 요청을 보낸다. 
2. 사용자로부터의 요청을 아무런 검증없이 서버에 전송한다. 
3. 요청된 명령을 서버에서 실행하고, 서버의 민감정보를 그대로 노출한다. 

그 이후 여러 가지 명령어로 정보를 수집한 해커는 서버 내 라이브러리 중 원데이 취약점을 이용하여 리눅스 서버의 root 권한을 획득한다.

해당 웹 서버 개발자는 해커를 위한 웹셸을 만들어 둔 것이나 다름 없다. 서버의 명령을 실행하는 함수는 되도록이면 사용하지 말아야 하고, 사용하더라도 서버에 영향을 끼칠 수 있는 명령어는 사용이 불가능 하도록 하여야 한다다. 실 서버와 분리하여 운영하는 것도 좋은 방법이다.

---

## File Vulnerability

### 파일 업로드 취약점
사용자가 원하는 경로나 파일명으로 업로드하여 악영향을 미칠 수 있다.

파일 업로드 기능은 사용자의 파일이 서버의 파일 시스템에 저장되어 처리된다는 이유로 인해 취약점이 발생할 수 있다. 즉, 서버의 파일 시스템에 원하는 파일을 저장할 수 있다. 웹 서비스가 동작하는 경로에 사용자가 원하는 파일 내용과 파일 명을 업로드 할 수 있다면서버가 엔진에 요청하는 확장자를 업로드하여 서버의 웹 어플리케이션에 원하는 코드를 실행 할 수 있다.

### 파일 다운로드 취약점
의도하지 않은 파일을 다운로드 할 수 있다.

사용자가 입력한 파일 이름을 검증하지 않은 채 그대로 다운로드 시켜주게 되면 발생할 수 있다. Path Traversal을 이용하면 개발자가 의도한 폴더의 상위 경로에 존재하는 파일 또한 다운로드 할 수 있다.

이를 방지하기 위해서는 기본적으로 인자에 다운로드 받으려는 파일의 경로나 이름을 넘기지 않는 것이 좋다. 또한 상대경로로 올라가는데 사용될 수 있는 문자를 적절하게 필터링해야 한다.
