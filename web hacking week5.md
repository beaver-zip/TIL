## Server Side Request Forgery

### 특징
SSRF 공격은 중간에 사용자를 개입시킬 필요 없이 웹 서버 자체를 노린다. 
공격자는 악성 HTTP 요청을 서버에 보내는 것만으로 백엔드에 지시해 악성 작업을 수행할 수 있다.

### 사례
2019년 미국과 캐나다에 걸쳐 약 1억 600만 명의 사용자에게 영향을 미친 캐피털 원(Capital One) 데이터 침해 사건의 시작은 SSRF 취약점 악용이었다. 이때 침해된 데이터는 고객 이름, 주소, 연락처 정보, 생년월일, 미국 사회보장번호(SSN), 캐나다 사회보험번호(SIN), 신용 점수, 결제 내역, 자진 신고 수입 금액 등이었다. 

클라우드플레어(Cloudflare)의 에반 존슨을 포함한 많은 사이버보안 전문가가 이 사고를 SSRF 공격으로 규정했다. 2021년 3월에 공개된 마이크로소프트 익스체인지 제로 데이(CVE-2021-26855)와 최근 발견된 프록시셸(ProxyShell) 익스플로잇 모두 활발하게 악용되고 있는데, SSRF에 대한 결함이 그 원인이다.

### 공격 방식 
방문자가 웹 서버에 요청하거나 하이퍼링크를 클릭하면 방문자에게는 공개된 파일, 즉 public_html이나 www 폴더에 있는 파일이 제공된다. 비공개 폴더 또는 데이터베이스에 있는 파일은 일반적으로 서버 관리자와 같이 더 높은 권한이 있는 사람만 접근하도록 제한된다.

그러나 웹을 서핑하는 일반 사용자가 직접 접근할 수 있는 파일과 자산을 서버 자체가 접근할 수 있다. 예를 들어 방문자는 https://www.csoonline.com/uk/events와 같은 공개 URL을 손쉽게 요청할 수 있지만 '/etc/shadow' 또는 '/etc/passwd'와 같은 CSO 서버의 민감한 시스템 파일은 요청할 수 없다. 웹 서버는 이런 파일에 접근할 수 있을 가능성이 높다.

### 완화 방법
SSRF 결함을 완화하는 기본적인 방법은 내부 애플리케이션과 접촉하는 입력에 대해 사용자가 영향을 미치지 못하도록 하는 것이다. 내부 애플리케이션은 무조건적으로 입력을 신뢰하거나 정상적인 사용자로부터의 입력이라고 가정해서는 안 된다.

두 번째로, 프로그램의 로직을 수정할 수 없고 URL이 절대적으로 필요하다면, 얼로우리스트(Allowlist)와 디나이리스트(denylist)가 해법이 된다. 예를 들어 오쓰(OAuth) 기반 로그인을 구현하는 일부 애플리케이션은 다른 URL 매개변수와 함께 요청 간에 '리디렉션(redirect) URL'을 제출하며 SSRF에 취약한 것으로 확인됐다.